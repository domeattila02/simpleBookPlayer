(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();class v{audio=null;_currentPosition=0;load(i){this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio(i),this.audio.currentTime=this._currentPosition,this.audio.addEventListener("timeupdate",()=>{this._currentPosition=this.audio.currentTime})}play(){this.audio&&(this.audio.currentTime=this._currentPosition,this.audio.play())}pause(){this.audio&&(this.audio.pause(),this._currentPosition=this.audio.currentTime)}stop(){this.audio&&(this.audio.pause(),this.audio.currentTime=0,this._currentPosition=0)}setCurrentPosition(i){this._currentPosition=i,this.audio&&(this.audio.currentTime=i)}get currentPosition(){return this._currentPosition}isLoaded(){return this.audio!==null}}class E{key="audiobookProgress";save(i,r){const s=this.loadAll();s[i]=r,localStorage.setItem(this.key,JSON.stringify(s))}load(i){return this.loadAll()[i]||0}loadAll(){try{return JSON.parse(localStorage.getItem(this.key)||"{}")}catch{return{}}}}const e=new v,c=new E;let a="";const f=document.getElementById("fileInput"),g=document.getElementById("playButton"),y=document.getElementById("pauseButton"),P=document.getElementById("stopButton"),d=document.getElementById("progressBar"),L=document.getElementById("rewindButton"),B=document.getElementById("forwardButton"),m=document.getElementById("currentTime"),p=document.getElementById("duration");function h(t){if(isNaN(t)||!isFinite(t))return"00:00";const i=Math.floor(t/60),r=Math.floor(t%60);return`${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function u(){if(e.isLoaded()&&e.audio){const t=e.audio;t.duration>0?(d.max=t.duration.toString(),d.value=t.currentTime.toString(),m.textContent=h(t.currentTime),p.textContent=h(t.duration)):(d.value="0",m.textContent="00:00",p.textContent="00:00")}}L.addEventListener("click",()=>{if(e.isLoaded()&&e.audio){const t=e.audio;t.currentTime=Math.max(0,t.currentTime-10),e.setCurrentPosition(t.currentTime),u()}});B.addEventListener("click",()=>{if(e.isLoaded()&&e.audio){const t=e.audio;t.currentTime=Math.min(t.duration,t.currentTime+10),e.setCurrentPosition(t.currentTime),u()}});d.addEventListener("input",()=>{if(e.isLoaded()&&e.audio){const t=e.audio;t.currentTime=parseFloat(d.value),e.setCurrentPosition(t.currentTime)}});f.addEventListener("change",()=>{const t=f.files?.[0];if(t){a=t.name;const i=URL.createObjectURL(t),r=c.load(a);e.setCurrentPosition(r),e.load(i),g.disabled=!1,y.disabled=!1,P.disabled=!1,L.disabled=!1,B.disabled=!1,setTimeout(()=>{if(e.audio){const s=e.audio;s.addEventListener("timeupdate",u),s.addEventListener("loadedmetadata",u),u()}},100)}});y.addEventListener("click",()=>{e.pause(),a&&c.save(a,e.currentPosition)});P.addEventListener("click",()=>{e.stop(),a&&c.save(a,0)});window.addEventListener("beforeunload",()=>{a&&c.save(a,e.currentPosition)});g.addEventListener("click",()=>{if(!e.isLoaded()){alert("Please select an audiobook file first.");return}e.play()});
